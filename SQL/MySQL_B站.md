# MySQL B站

##  0. B树和B+树之间的区别是什么?
```text
1、一个节点里面有多个元素
2、元素有排序
3、叶子节点之间有指针
4、非叶子节点上面的元素都冗余了一份在叶子上面
```

##  1. Innodb中的B+树是怎么产生的?
```text

```

##  2. 高度为3的B+树能存多少条数据?
```text
每页 16kb 一个主键int 4字节，一个指针6字节，假设每条记录1kb
4b + 6b = 10b
16kb/10b = 1638 页
1638 * (16kb/1kb) = 26,208 条   两层
1638 * 1638 * (16kb/1kb) = 42,928,704   三层

```

##  3. Innodb是如何支持范围查找能走索引的?
```text
B+ 树就是主键索引，索引和数据存在一起，就叫做聚簇索引
eg：select * from a>6 ; 先找到a=6，在返回右边的数据。

```

##  4. 为什么要遵守最左前缀原则才能利用到索引?
```text
create index idx_t1_bcd on t1(b,c,d);  -- t1表创建bcd联合索引

explain select b from t1 order by b,c,d;  -- 走索引
                                        -- 全部扫描 额外排序（内存） + 不用回表
主要看查询条件有没有给最左边的那个条件b，如果没有则无法走索引
explain select * from t1 where b=1 and c=1 and d=1; -- 走索引，有b

```

##  5. 范围查找导致索引失效原理分析?
```text
对于任何一个sql，既可以走索引，有可以走全表扫描

explain select * from t1 where b>1;  -- 不走索引，没有全表扫描快

条件要越精确越好，
```

##  6. 覆盖索引的底层原理?
```text
sql里面查询的字段正好在所在的索引中，者可以直接返回，不用在全表扫描
explain select b from t1 where b>1;  -- 走索引
explain select b,c,d,a from t1 where b>1;  -- 走索引,因为a是主键，他存在在bcd的叶子节点下面，都属于覆盖索引
explain select b,c,d,a,e from t1 where b>1;  -- 不走索引,因为e不在bcd所索引树上面只能回表
```

##  7. 索引扫描底层原理?
```text
explain select b from t1;  -- 走bcd索引，可以全表扫描返回 
        -- 从主键索引的叶子节点去遍历，完整数据
        -- 也可以走bcd索引的叶子节点区遍历，不完整数据，只是遍历的数据不一样

```

##  8. order by为什么会导致索引失效?
```text
explain select * from t1 order by b,c,d;  -- 走bcd索引，取出来的数据不需要排序，需要回表 慢
                                        -- 全部扫描 额外排序（内存） + 不用回表 快
explain select b from t1 order by b,c,d;  -- 走bcd索引，不需排序，不需回表
                                        -- 全部扫描 额外排序（内存） + 不用回表
```

##  9. mysql中的数据类型转换有哪些要注意的?
```text
字符串作为索引 e 是varchar
-- 把字符串转化为0,将数字字符串转化为数字

select 'a'=0;  -- 1 等式左右两边相等
select 'b'=1;  -- 0 等式左右两边不相等
select '123'=123; -- 1
```

##  10. 对字段进行操作导致索引失效原理?
```text
explain select * from t1 where e = 1; -- 0  改字段，索引失效，查不到数据
```

##  11. 二叉搜索树和平衡二叉树有什么关系?
```text
平衡二叉树也叫平衡二叉搜索树，是二叉树的升级版，
二叉搜索树是指节点左边的所有节点都比该节点小，节点右边的节点都比该节点大，
而平衡二叉树是在二叉搜索树的基础上还规定了节点两边的子树高度差的绝对值不能超过1
```

##  12. 强平衡二叉树和弱平衡二叉树有什么区别?
```text
强平衡二叉树AVL树，弱平衡二叉树就是我们说的红黑树。
1、AVL树比红黑树对于平衡的程度更加严格，在相同的节点情况下，AVL树的高度低于红黑树
2、红黑树中增加了一个节点颜色的概念
3、AVL树的旋转操作比红黑树的旋转操作更加耗时
```

##  13. B树和B+树的区别，为什么Mysql使用B+树?
```text
B树的特点：
    1、节点排序
    2、一个节点村多个元素，多个元素也排序了

B+树的特点：
    1、拥有B树的特点
    2、叶子节点之间有指针
    3、非叶子节点上的元素在叶子节点上都冗余了，也就是叶子节点中存储了所有的元素，并且排好顺序

MySQL索引使用的是B+树，因为索引是用来加快查询的，而B+树通过对数据进行排序，所以是可以提高查询速度的，
然后通过一个节点中可以存储多个元素，从而可以使得B+树的高度不会太高，在MySQL中一个Innodb页就是一个B+树节点，
一个Innodb页默认16kb，所以一般情况下一颗两层的B+树可以存2000万行左右的数据，然后通过利用B+树叶子节点存储了所有数据并且进行了排序，
并且叶子节点之间有指针，可以很好的支持全表扫描，范围查找等SQL语句。
```

##  14. epoll和poll的区别?
```text
1、select模型，使用的是数组来存储Socket连接描述文件符，容量是固定的，需要通过轮询来判断是否发生了IO事件
2、poll模型，使用的是链表来存储Socket连接描述文件符，容量是不固定的，需要通过轮询来判断是否发生了IO事件
3、epoll模型，epoll和poll是完全不同的，epoll是一种事件通知模型，当发生了IO事件时，应用程序才进行IO操作，不需要像poll模型那样主动去轮询
```

##  15. Mysql的锁你了解哪些?
```text
按锁的粒度划分：
    1、行锁：锁某行数据，锁粒度最小，并发度高
    2、表锁：锁整张表，锁粒度大，并发度低
    3、间隙锁：锁的是一个区间

或者：
    1、共享锁：也就是读锁，一个事务给某行数据加了读锁，其他事务也可以读，但是不能写
    2、排他锁：也就是写锁，一个事务给某行数据加了读锁，其他事务也不能读，也不能写

或者：
    1、乐观锁：并不会真正的去锁某行记录，而是通过一个版本号来实现的
    2、悲观锁：上面的行锁，表锁等都是悲观锁

在事务的隔离级别实现中，就需要利用锁来解决幻读
```

##  16. 最左前缀原则是什么?
```text
当一个SQL想要利用索引时就一定要提供该索引对应的字段中的最昨边的字段，也就是排在最前面的字段，
比如针对abc三个字段建立一个联合索引，那么在写一个sql时就一定要提供a字段的条件，这样才能用到联合索引，这是由于在建立abc三个字段的联合索引时，底层的B+树是按照abc三个字段从左到右去比较大小进行排序的，
所以如果利用B+树进行快速查找也得符合这个规则
```

##  17. Mysql慢查询该如何优化?
```text
1、检查时候走了索引，如果没有则优化SQL利用索引
2、检查所利用的索引，是否是最优索引
3、检查所查字段时候都是必须的，是否查询了过多的字段，查出了多余的数据
4、检查表中的数据是否过多，是否该进行分库分表了
5、检查数据库实例所在的机器的性能配置，是否太低，是否可以适当增加资源
```

##  18. Mysql中有哪些存储引擎?
```text
InnoDB存储引擎
    是MySQL的默认事务型引擎，也是最重要、使用最广泛的存储引擎。
    它被设计用来处理大量的短期（short-lived）事务，应该优先考虑Innodb引擎。

MyISAM存储引擎
    在MySQL 5.1 及之前的版本，MyISAM是默认的存储引擎。
    但是MyISAM不支持事务和行级锁，而且崩溃后无法安全恢复。
    同时MyISAM对整张表加锁，很容易因为表锁的问题导致典型的性能问题。

Memory引擎
Archive引擎
CSV引擎
```

##  19. MyISAM和InnoDB的区别是什么?
```text
1、InnoDB支持事务，MyISAM不支持事务。
    这是MySQL将默认存储引擎从MyISAM变成InnoDB的重要原因之一
2、InnoDB支持外键，而MyISAM不支持。
    对一个包含外键的InnoDB表转化为myisam会失败
3、InnoDB是聚集索引，myisam是非聚集索引
    聚簇索引的文件存放在主键索引的叶子节点上因此InnoDB必须要有主键，通过主键索引效率很。但是辅助索引需要两次查询，先查询主键查询到的数据。因此，主键不应该过大，因为主键太大，其他索引也都会很大。
    而myisam是非聚集索引，数据文件是分离的，索引保存的是数据文件的指针。主键索引和辅助索引是独立的。
4、InnoDB不保存表的具体行数，执行 select count(*) from table 时需要全表扫描。
    而myisam用一个变量保存了整个表的行数，执行上述语句时只需要读出该变量即可，速度很快。
5、InnoDB最小的锁的粒度是行锁，myisam最小的粒度是表锁。
    一个更新语句会锁住整张表，导致其他查询和更新都会被阻塞，因此并发访问受限。这是MySQL将默认存储引擎从MyISAM变成InnoDB的重要原因之一
```

##  20. 数据表设计时，字段你会如何选择?
```text

```

##  21. Mysql中VARCHAR(M)最多能存储多少数据?
```text

```

##  22. 请说下事务的基本特性?
```text

```

##  23. 事务并发可能引发什么问题?
```text

```

##  24. 简单描述下Mysql各种索引?
```text

```

##  25. 什么是三星索引?
```text

```

##  26. InnoDB一颗B+树可以存放多少行数据?
```text

```

##  27. Mysq如何实现读写分离?
```text

```

##  28. Mysq如何实现分库分表?
```text

```

##  29. mysql索引结构，各自的优劣?
```text

```

## ?

